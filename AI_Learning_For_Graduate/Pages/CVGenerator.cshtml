@page
@model CVGeneratorModel
@{
    ViewData["Title"] = "Tạo CV bằng AI hoặc thủ công";
}

<h2 class="mb-4">Tạo CV</h2>

<form method="post">
    <div class="mb-3">
        <label for="Prompt" class="form-label">Mô tả yêu cầu CV (prompt)</label>
        <textarea class="form-control" id="Prompt" name="Prompt" rows="3">@Model.Prompt</textarea>
        <button type="submit" name="mode" value="ai" class="btn btn-info mt-2">Generate từ AI</button>
    </div>

    <hr />

    <h4 class="mt-4">Thông tin CV</h4>

    <div class="mb-3">
        <label for="FullName" class="form-label">Họ và tên</label>
        <input type="text" class="form-control" id="FullName" name="FullName" value="@Model.FullName" />
    </div>

    <div class="mb-3">
        <label for="Education" class="form-label">Học vấn</label>
        <textarea class="form-control" id="Education" name="Education" rows="2">@Model.Education</textarea>
    </div>

    <div class="mb-3">
        <label for="Experience" class="form-label">Kinh nghiệm làm việc</label>
        <textarea class="form-control" id="Experience" name="Experience" rows="3">@Model.Experience</textarea>
    </div>

    <div class="mb-3">
        <label for="Skills" class="form-label">Kỹ năng</label>
        <textarea class="form-control" id="Skills" name="Skills" rows="2">@Model.Skills</textarea>
    </div>

    <button type="submit" name="mode" value="manual" class="btn btn-success">Lưu CV thủ công</button>
</form>

@if (!string.IsNullOrWhiteSpace(Model.FullName))
{
    <hr />
    <h3 class="mt-5">📄 Preview CV</h3>
    <div class="card shadow-sm mb-5">
        <div class="card-body">
            <div class="d-flex align-items-center mb-3">
                <div class="flex-grow-1">
                    <h4 class="fw-bold mb-0">@Model.FullName</h4>
                    <small class="text-muted">Lập trình viên phần mềm</small>
                </div>
                <div>
                    <img src="https://via.placeholder.com/80x80.png?text=Avatar" class="rounded-circle border" alt="Avatar" />
                </div>
            </div>

            <hr />

            <h5 class="text-primary">🎓 Học vấn</h5>
            <p>@Model.Education</p>

            <h5 class="text-primary">💼 Kinh nghiệm</h5>
            <p>@Model.Experience</p>

            <h5 class="text-primary">🛠️ Kỹ năng</h5>
            <p>@Model.Skills</p>
        </div>
    </div>
}
@if (ViewData["IPFS_CID"] != null)
{
    <div class="alert alert-success mt-4">
        ✅ CV đã được lưu lên IPFS qua Pinata! <br />
        CID: <strong>@ViewData["IPFS_CID"]</strong> <br />
        Link: <a href="https://gateway.pinata.cloud/ipfs/@ViewData["IPFS_CID"]" target="_blank">Xem CV trên IPFS</a>
    </div>
}